# Серверный рендеринг

Для серверного рендеринга необходимо инициализировать роутер на сервере и передать сформированный
`router.state` браузеру. Утилиты `escapeAllStrings` и `unescapeAllStrings` не включены в библиотеку.

### Сервер

<!-- @include: @shared/ssr/server.md -->

В данном коде в итоговый html не вставляются ссылки на js и css файлы, обычно это делается
бандлером. Полный код с настройкой бандлера можно посмотреть в <Link to="examples">Примерах</Link>.

Для цепочек редиректов на сервере используется `if (error instanceof RedirectError) return res.redirect(error.message)`. 
Эта ошибка выбрасывается, когда в `beforeEnter` вернулся редирект на другой `Config`, например, 
если пользователь не прошел авторизацию и пытается зайти в авторизованную зону.

::: tip
Способ сериализации `JSON.parse(JSON.stringify(router.state))` достаточен, так как `router.state` -
простая структура. Однако если в `Config.props` переданы сложные данные (классы, объекты с методами, Date и т.п.),
то лучше перед сериализацией на сервере их удалять. На клиенте они проставятся автоматически при вызове 
<Link to="api/router#router-hydratefromstate">router.hydrateFromState</Link>
:::

### Клиент

<!-- @include: @shared/ssr/client.md -->
